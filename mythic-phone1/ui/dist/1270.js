"use strict";(self.webpackChunkmythic_phone=self.webpackChunkmythic_phone||[]).push([[1270],{31270:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var a=n(68175),r=n(28407),c=n(73925),l=n(70232),o=n.n(l),i=n(55429),s=n(15647),u=n(64965),m=n(142),d=n(79111),p=n(32764),g=n(26573),f=n(97982),h=n(77532),E=n(33268),v=n(78060),y=n(32455),A=n(74552),x=n(59530),w=n(60737),b=n(93632),D=n.n(b),S=n(51698),k=n.n(S),C=n(87591),N=n(81943),j=n.n(N),O=n(23470),T=n(61541);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=(0,A.A)((function(e){return{wrapper:{height:"100%",background:e.palette.secondary.main,overflowY:"auto",overflowX:"hidden"},header:{background:"#696969",fontSize:20,padding:15,lineHeight:"50px",height:78},subHeader:{padding:"7px 15px",backgroundColor:"#414141"},subsubHeader:{padding:"7px 15px",backgroundColor:e.palette.secondary.light},container:{padding:"10px 20px",height:"80%",overflow:"hidden"},body:{padding:"10px 20px",height:"70%",overflowX:"hidden",overflowY:"auto"},editField:{marginTop:20,width:"100%"},signature:{padding:"15px 35px",height:"12%",overflowX:"hidden",overflowY:"auto",textAlign:"center"},input:{width:"100%",padding:"0 10px"},messageImg:{display:"block",maxWidth:200},copyableText:{color:e.palette.primary.main,textDecoration:"underline","&:hover":{transition:"color ease-in 0.15s",color:e.palette.text.main,cursor:"pointer"}},documentContainer:{overflowWrap:"break-word","& .ql-size-huge":{fontSize:"2.5em"},"& .ql-size-large":{fontSize:"1.5em"},"& .ql-size-small":{fontSize:"0.75em"},"& .ql-font-serif":{fontFamily:"Georgia, Times New Roman, serif"},"& .ql-font-monospace":{fontFamily:"Monaco, Courier New, monospace"},"& .ql-align-center":{textAlign:"center"},"& .ql-align-right":{textAlign:"right"},"& .ql-align-justify":{textAlign:"justify"},"& .ql-syntax":{color:"#f8f8f2",overflow:"visible",backgroundColor:"#23241f !important"}}}}));const P=function(e){var t,n,a,l,A=q(),b=(0,s.wA)(),S=(0,u.W6)(),N=(0,O.MW)(),I=e.match.params,P=I.id,L=I.mode,_=("edit"==L||"new"==L)&&L,W=(0,s.d4)((function(e){return e.data.data.player})),z=(0,s.d4)((function(e){return e.data.data.myDocuments})).find((function(e){return e._id===P})),H=(0,i.useState)(null),R=(0,c.A)(H,2),M=R[0],U=R[1],B=(0,i.useState)(!1),V=(0,c.A)(B,2),X=V[0],Y=V[1],$=(0,i.useState)(!1),G=(0,c.A)($,2),K=G[0],Z=G[1],J=(0,i.useState)(!1),Q=(0,c.A)(J,2),ee=Q[0],te=Q[1],ne=(0,i.useState)(!1),ae=(0,c.A)(ne,2),re=ae[0],ce=ae[1],le=(0,i.useState)({title:null!==(t=null==z?void 0:z.title)&&void 0!==t?t:"",content:null!==(n=null==z?void 0:z.content)&&void 0!==n?n:"",time:1645026791}),oe=(0,c.A)(le,2),ie=oe[0],se=oe[1];(0,i.useEffect)((function(){if((!_||"edit"===_&&z)&&se(z),!_){if(z.signed&&z.signed.length>0){var e=z.signed.find((function(e){return e.ID==W.ID}));Z(Boolean(e)),te(Boolean(e))}else Z(!1),te(!1);var t=!1;if(z.sharedWith&&z.sharedWith.length>0){var n=z.sharedWith.find((function(e){return e.ID==W.ID}));n&&n.RequireSignature&&(t=!0)}Y(t)}}),[P,L]);var ue=function(){var e=(0,r.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("edit"!==_){e.next=18;break}if(!(ie.title.length>=2)){e.next=17;break}return e.prev=2,e.next=5,T.A.send("EditDocument",{id:ie._id,data:{title:ie.title,content:ie.content}});case 5:return e.next=7,e.sent.json();case 7:e.sent?(b({type:"UPDATE_DATA",payload:{type:"myDocuments",id:ie._id,data:ie}}),S.replace("/apps/documents/view/".concat(P,"/v")),N("Document Edited Successfully")):N("Error Editing Document"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0),N("Error Editing Document");case 15:e.next=18;break;case 17:N("Must Include Title");case 18:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=(0,r.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.A.send("DeleteDocument",{id:ie._id});case 3:return e.next=5,e.sent.json();case 5:e.sent?(b({type:"REMOVE_DATA",payload:{type:"myDocuments",id:ie._id}}),S.replace("/apps/documents/"),N("Document Deleted Successfully")):N("Error Deleting Document"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),N("Error Deleting Document");case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=(0,r.A)(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.A.send("CreateDocument",ie);case 3:return e.next=5,e.sent.json();case 5:(t=e.sent)?(b({type:"ADD_DATA",payload:{type:"myDocuments",data:t}}),S.replace("/apps/documents/view/".concat(t._id,"/v")),N("Document Created Successfully")):N("Error Creating Document"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),N("Error Creating Document");case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=(0,r.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:U({target:"",type:1,nearby:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=(0,r.A)(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=F(F({},M),{},{target:+M.target,document:ie}),U(null),e.prev=2,e.next=5,T.A.send("ShareDocument",t);case 5:return e.next=7,e.sent.json();case 7:n=e.sent,N(n?"Document Shared":"Unable to Share Document"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0),N("Unable to Share Document");case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=(0,r.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return te(!0),e.prev=1,e.next=4,T.A.send("SignDocument",ie._id);case 4:return e.next=6,e.sent.json();case 6:e.sent?(N("Document Signed"),Z(!0)):(N("Unable to Sign Document"),te(!1)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),N("Unable to Sign Document"),te(!1);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),he=null!==(a=null==ie?void 0:ie.content)&&void 0!==a?a:"";return[{regex:/((https?:\/\/(www\.)?(i\.)?imgur\.com\/[a-zA-Z\d]+)(\.png|\.jpg|\.jpeg|\.gif)?)/gim,replace:'<LightboxImage className={classes.messageImg} src={"$1"} />'},{regex:/(http|https):\/\/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)(mp4)/gim,replace:'<div>\n    \t\t\t<ReactPlayer\n    \t\t\t\tkey={key}\n    \t\t\t\tvolume={0.25}\n    \t\t\t\twidth="100%"\n    \t\t\t\tcontrols={true}\n    \t\t\t\turl={"$1"}\n    \t\t\t/>\n    \t\t</div>'}].forEach((function(e){he=he.replace(e.regex,e.replace)})),i.createElement(i.Fragment,null,i.createElement("div",{className:A.wrapper},i.createElement(m.A,{position:"static",className:A.header},i.createElement(d.Ay,{container:!0},i.createElement(d.Ay,{item:!0,xs:7,style:{lineHeight:"50px"}},"My Documents"),i.createElement(d.Ay,{item:!0,xs:5,style:{textAlign:"right"}},"new"==_&&i.createElement(p.A,{title:"Create"},i.createElement("span",null,i.createElement(g.A,{className:A.headerAction,onClick:de},i.createElement(x.g,{className:"fa",icon:["fas","floppy-disk"]})))),"edit"==_&&i.createElement(p.A,{title:"Edit & Save"},i.createElement("span",null,i.createElement(g.A,{className:A.headerAction,onClick:ue},i.createElement(x.g,{className:"fa",icon:["fas","floppy-disk-pen"]})))),!_&&ie.owner==W.ID&&(!ie.signed||(null==ie||null===(l=ie.signed)||void 0===l?void 0:l.length)<=0)&&i.createElement(i.Fragment,null,i.createElement(p.A,{title:"Edit"},i.createElement("span",null,i.createElement(g.A,{className:A.headerAction,onClick:function(){S.push("/apps/documents/view/".concat(P,"/edit"))}},i.createElement(x.g,{className:"fa",icon:["fas","pen-to-square"]}))))),(!_||"edit"==_)&&i.createElement(i.Fragment,null,i.createElement(p.A,{title:"Delete"},i.createElement("span",null,i.createElement(g.A,{className:A.headerAction,onClick:me},i.createElement(x.g,{className:"fa",icon:["fas","trash-can-xmark"]}))))),!_&&i.createElement(i.Fragment,null,ie.signed&&ie.signed.length>0&&i.createElement(p.A,{title:"View Signatures"},i.createElement("span",null,i.createElement(g.A,{className:A.headerAction,onClick:function(){return ce(!0)}},i.createElement(x.g,{className:"fa",icon:["fas","signature"]})))),i.createElement(p.A,{title:"Share"},i.createElement("span",null,i.createElement(g.A,{className:A.headerAction,onClick:function(){return pe(!1)}},i.createElement(x.g,{className:"fa",icon:["fas","share"]})))),i.createElement(p.A,{title:"Nearby Share"},i.createElement("span",null,i.createElement(g.A,{className:A.headerAction,onClick:function(){return pe(!0)}},i.createElement(x.g,{className:"fa",icon:["fas","tower-broadcast"]})))))))),i.createElement(m.A,{position:"static",className:A.subHeader},i.createElement(d.Ay,{container:!0},i.createElement(d.Ay,{item:!0,xs:6,style:{maxWidth:"20ch",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},ie.title),i.createElement(d.Ay,{item:!0,xs:6,style:{textAlign:"right"}},"new"!=_&&ie.time&&i.createElement(i.Fragment,null,"Edited "," ",i.createElement(k(),{className:A.postedTime,interval:6e4,fromNow:!0,unix:!0},+ie.time))))),_?i.createElement("div",{className:A.container},i.createElement(E.A,{className:A.creatorInput,fullWidth:!0,label:"Title",variant:"outlined",onChange:function(e){se(F(F({},ie),{},{title:e.target.value}))},value:ie.title,inputProps:{maxLength:100}}),i.createElement(C.KE,{value:ie.content,onChange:function(e){se(F(F({},ie),{},{content:e}))},placeholder:"Write Stuff Here"})):i.createElement(i.Fragment,null,i.createElement("div",{className:A.body},i.createElement(j(),{autoCloseVoidElements:!0,bindings:{classes:A},className:A.documentContainer,components:{LightboxImage:C.vB,ReactPlayer:D(),CopyToClipboard:w.CopyToClipboard},jsx:he,blacklistedTags:["iframe","script","link","applet","style"]})),X&&i.createElement("div",{className:A.signature},i.createElement(f.A,{control:i.createElement(h.A,{disabled:ee,checked:K,onChange:function(e){return fe(e)}}),label:"".concat(K?"Document Signed":"Sign Document"," (as ").concat(W.First[0],". ").concat(W.Last,")")})))),null!=M&&i.createElement(C.aF,{open:null!=M,title:"Share This Document",onAccept:ge,onClose:function(){return U(null)},acceptLang:"Share",closeLang:"Cancel"},i.createElement("div",null,"Sharing without making a copy will allow the recipient to see any changes you make to the document!",i.createElement(v.A,{id:"targetType",name:"targetType",className:A.editField,value:M.type,onChange:function(e){U(F(F({},M),{},{type:e.target.value}))}},i.createElement(y.A,{value:1},"Share a Copy"),i.createElement(y.A,{value:2,disabled:ie.owner!==W.ID||ie.shared},"Share"),i.createElement(y.A,{value:3,disabled:ie.owner!==W.ID||ie.shared},"Share w/ Signature Request")),!M.nearby&&i.createElement(E.A,{required:!0,fullWidth:!0,className:A.editField,label:"State ID",name:"target",type:"text",value:M.target,helperText:"The State ID of who you want to share the document with.",inputProps:{maxLength:6},onChange:function(e){U(F(F({},M),{},{target:e.target.value}))}}))),re&&i.createElement(C.aF,{open:re,title:"Document Signatures",onClose:function(){return ce(!1)},closeLang:"Close"},i.createElement("div",null,ie.signed.map((function(e){return i.createElement("p",{key:e.ID},"".concat(e.First," ").concat(e.Last," (State ID: ").concat(e.SID,") on "),i.createElement(k(),{format:"LLL",unix:!0},+e.Time))})))))}}}]);