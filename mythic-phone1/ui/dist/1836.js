"use strict";(self.webpackChunkmythic_phone=self.webpackChunkmythic_phone||[]).push([[1836],{61836:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var r=n(28407),a=n(73925),o=n(70232),i=n.n(o),c=n(55429),s=n(15647),l=n(142),u=n(79111),d=n(32764),m=n(26573),p=n(55834),f=n(59757),b=n(87831),h=n(97982),g=n(77532),v=n(49999),y=n(53858),A=n(40178),k=n(69484),x=n(33268),E=n(43502),w=n(78060),C=n(32455),S=n(74552),T=n(59530),V=n(61541),N=n(87591),P=n(84529),B=n(23470),_=(0,S.A)((function(e){return{wrapper:{height:"100%",background:e.palette.secondary.main},inner:{position:"relative",height:"100%"},votingContainer:{height:"82%",overflow:"auto",padding:"0.5vh","&::-webkit-scrollbar":{width:6},"&::-webkit-scrollbar-thumb":{background:"#ffffff52"},"&::-webkit-scrollbar-thumb:hover":{background:"#1de9b6"},"&::-webkit-scrollbar-track":{background:"transparent"}},header:{background:"#787777",fontSize:20,padding:15,lineHeight:"45px",height:78},businessItem:{background:e.palette.secondary.dark},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},editField:{marginBottom:15,"&::-webkit-scrollbar":{width:6},"&::-webkit-scrollbar-thumb":{background:"#ffffff52"},"&::-webkit-scrollbar-thumb:hover":{background:"#1de9b6"},"&::-webkit-scrollbar-track":{background:"transparent"}}}}));const j=function(e){var t=_(),n=(0,s.wA)(),o=(0,c.useState)(null),S=(0,a.A)(o,2),j=S[0],I=S[1],L=(0,c.useState)(""),O=(0,a.A)(L,2),z=O[0],R=O[1],F=(0,c.useState)(!1),M=(0,a.A)(F,2),W=M[0],D=M[1],G=(0,c.useState)(""),H=(0,a.A)(G,2),J=H[0],q=H[1],K=(0,c.useState)(!1),Q=(0,a.A)(K,2),U=Q[0],X=Q[1],Y=(0,c.useState)(""),Z=(0,a.A)(Y,2),$=Z[0],ee=Z[1],te=(0,c.useState)(""),ne=(0,a.A)(te,2),re=ne[0],ae=ne[1],oe=(0,s.d4)((function(e){return e.data.data.player.PhonePermissions})),ie=((0,s.d4)((function(e){return e.data.data.externalJobs})),(0,B.MW)()),ce=(0,s.d4)((function(e){return e.voting.tab})),se=(0,s.d4)((function(e){return e.voting.voted})),le=(0,s.d4)((function(e){return e.voting.candidates})),ue=function(){var e=(0,r.A)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V.A.send("Phone:Voting:Vote",{vote:z,person:j});case 3:return e.next=5,e.sent.json();case 5:if(!(n=e.sent)){e.next=11;break}return ie(n?"Vote Submitted":"Something went wrong."),e.abrupt("return",!0);case 11:return e.abrupt("return",!1);case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),de=(0,c.useMemo)((function(){return(0,P.throttle)((0,r.A)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V.A.send("Phone:Voting:GetCandidates");case 3:return e.next=5,e.sent.json();case 5:if(!(t=e.sent)){e.next=11;break}me(t),n({type:"SET_VOTING_CANDIDATES",payload:{data:t}}),e.next=12;break;case 11:throw t;case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:case"end":return e.stop()}}),e,null,[[0,14]])}))),5e3)}),[]),me=function(){var e=(0,r.A)(i().mark((function e(t){var r,a,o,c,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object.keys(t),a=0,o=r;case 2:if(!(a<o.length)){e.next=18;break}return c=o[a],e.prev=4,e.next=7,V.A.send("Phone:Voting:GetVotes",{vote:c});case 7:return e.next=9,e.sent.json();case 9:(s=e.sent)&&n({type:"SET_VOTES_DONE",payload:{data:s}}),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(4);case 15:a++,e.next=2;break;case 18:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){de()}),[]);var pe=function(){var e=(0,r.A)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V.A.send("Phone:Voting:CreateCandidate",t);case 3:return e.next=5,e.sent.json();case 5:if(!e.sent){e.next=12;break}return D(!1),q(""),e.abrupt("return",!0);case 12:return e.abrupt("return",!1);case 13:e.next=19;break;case 15:return e.prev=15,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=(0,r.A)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe({name:J,category:$,jobRestriction:re});case 2:n=e.sent,q(""),D(!1),ie(n?"Candidate Added":"Could not create Candidate"),setTimeout((function(){de()}),700);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return c.createElement("div",{className:t.wrapper},c.createElement("div",{className:t.inner},c.createElement(l.A,{position:"static",className:t.header},c.createElement(u.Ay,{container:!0},c.createElement(u.Ay,{item:!0,xs:8,style:{lineHeight:"50px"}},"Voting"),c.createElement(u.Ay,{item:!0,xs:4,style:{textAlign:"right",display:oe.voting.admin?"":"none"}},c.createElement(d.A,{title:"Add Candidate"},c.createElement(m.A,{onClick:function(){return D(!0)}},c.createElement(T.g,{icon:["fas","plus"]})))))),c.createElement("div",{className:t.tabs},c.createElement(p.A,{value:ce,onChange:function(e,t){n({type:"SET_VOTING_TAB",payload:{tab:t}})},indicatorColor:"primary",textColor:"primary",variant:"fullWidth",scrollButtons:!1},c.createElement(f.A,{className:t.phoneTab,label:"Vote"}),c.createElement(f.A,{className:t.phoneTab,disabled:!oe.voting.admin,label:"Results"}))),c.createElement("div",{className:t.votingContainer},c.createElement(b.A,{style:{marginLeft:20,display:0===ce?"":"none"}},Object.keys(le).map((function(e){return c.createElement("div",{key:e,style:{display:(t=le[e][0].restricted,""===t||"none"===t||t?"":"none"),marginBottom:20}},c.createElement("h3",null,e),le[e].map((function(t){return c.createElement("div",{key:t.id,style:{marginBottom:10}},c.createElement(h.A,{control:c.createElement(g.A,{checked:j===t.id,onChange:function(e){var n;n=t.id,I(n),X(!0),R(t.vote_category)},sx:{"& .MuiSvgIcon-root":{fontSize:28}},disabled:se["VOTED_".concat(e)]}),label:c.createElement(c.Fragment,null,t.label,c.createElement(m.A,{disabled:!oe.voting.admin,onClick:(0,r.A)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,V.A.send("Phone:Voting:RemoveCandidate",{id:t.id});case 3:return e.next=5,e.sent.json();case 5:if(!e.sent){e.next=11;break}return setTimeout((function(){de()}),700),e.abrupt("return",!0);case 11:return e.abrupt("return",!1);case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))},c.createElement(T.g,{style:{color:"red",display:oe.voting.admin?"":"none"},icon:["fa","trash"]})))}))})));var t}))),c.createElement(v.A,{variant:"contained",disabled:!U,style:{height:"4vh",fontSize:"1.5vh",position:"absolute",bottom:60,width:"97.5%",marginLeft:"0.5%",display:0===ce?"":"none"},onClick:ue},"Submit Vote"),c.createElement(y.A,{sx:{width:"100%",padding:2,display:1===ce?"":"none"}},c.createElement(b.A,{style:{marginLeft:20,display:1===ce?"":"none"}},Object.keys(le).map((function(e){return c.createElement("div",{key:e,style:{marginBottom:20}},c.createElement("h3",null,e),le[e].map((function(e){return c.createElement("div",{key:e.id,style:{marginBottom:10}},c.createElement(y.A,{key:e.id,sx:{marginBottom:2}},c.createElement(A.A,{variant:"h6",gutterBottom:!0},e.label," - ",e.votes," Votes"),c.createElement(y.A,{sx:{display:"flex",alignItems:"center",marginTop:1}},c.createElement(y.A,{sx:{width:"100%",right:1}},c.createElement(k.A,{variant:"determinate",value:e.votes/500*100})))))})))})))))),c.createElement(N.aF,{form:!0,open:W,title:"Add Candidate",onClose:function(){return D(!1)},onAccept:fe,submitLang:"Add",closeLang:"Cancel"},c.createElement(x.A,{className:t.editField,label:"Name",name:"name",type:"text",fullWidth:!0,multiline:!0,required:!0,value:J,onChange:function(e){return q(e.target.value)},inputProps:{maxLength:180},InputLabelProps:{style:{fontSize:20}}}),c.createElement(x.A,{className:t.editField,label:"Job Restriction",name:"restriction",type:"text",fullWidth:!0,multiline:!0,value:re,onChange:function(e){return ae(e.target.value)},inputProps:{maxLength:180},InputLabelProps:{style:{fontSize:20}}}),c.createElement(E.A,{fullWidth:!0},c.createElement(w.A,{labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard",value:$,onChange:function(e){return ee(e.target.value)}},c.createElement(C.A,{value:"Commissioner"},"Commissioner"),c.createElement(C.A,{value:"Mayor"},"Mayor")))))}}}]);