"use strict";(self.webpackChunkmythic_phone=self.webpackChunkmythic_phone||[]).push([[3674,4350],{54350:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var n=r(28407),a=r(73925),i=r(70232),o=r.n(i),c=r(55429),u=r(44557),s=r(85220),l=r(68209),p=r(26573),d=r(74552),m=r(59530),g=r(87591),b=r(61541),f=r(23470),y=(0,d.A)((function(e){return{wrapper:{height:"100%",background:e.palette.secondary.main}}}));const v=function(e){var t=e.property,r=e.data,i=e.canRevoke,d=e.onRefresh,v=e.onUpdate,k=(y(),(0,f.MW)()),h=(0,c.useState)(!1),A=(0,a.A)(h,2),O=A[0],E=A[1],w=function(){var e=(0,n.A)(o().mark((function e(n){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.A.send("Home:RevokeDigiKey",{id:t.id,target:r.Char});case 3:return e.next=5,e.sent.json();case 5:if((a=e.sent).error){e.next=12;break}k("DigiKey Has Been Revoked"),E(!1),d(),e.next=29;break;case 12:e.t0=a.code,e.next=1===e.t0?15:2===e.t0?17:3===e.t0?19:4===e.t0?21:5===e.t0?23:6===e.t0?25:7===e.t0?27:29;break;case 15:return k("Error Occured"),e.abrupt("break",29);case 17:return k("Invalid Property"),e.abrupt("break",29);case 19:return k("Not Allowed"),e.abrupt("break",29);case 21:return k("Invalid Target Player"),e.abrupt("break",29);case 23:return k("Invalid Target Character"),e.abrupt("break",29);case 25:return k("Person Doesn't Have A DigiKey For Property"),e.abrupt("break",29);case 27:return k("Error Occured Revoking DigiKey"),e.abrupt("break",29);case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(0),console.log(e.t1);case 34:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(t){return e.apply(this,arguments)}}();return c.createElement(c.Fragment,null,c.createElement(u.Ay,{divider:!0},c.createElement(s.A,{primary:"".concat(r.First," ").concat(r.Last),secondary:r.Owner?"Owner":"Key Holder"}),i&&c.createElement(l.A,null,c.createElement(p.A,{onClick:v},c.createElement(m.g,{icon:["fas","pen-to-square"]})),c.createElement(p.A,{onClick:function(){return E(!0)}},c.createElement(m.g,{icon:["fas","trash"]})))),i&&c.createElement(g.pT,{title:"Revoke DigiKey?",open:O,confirm:"Yes",decline:"No",onConfirm:w,onDecline:function(){return E(!1)}},c.createElement("p",null,"Removing the DigiKey will revoke access to this property and shared assets for this person. Are you sure?")))}},33674:(e,t,r)=>{r.r(t),r.d(t,{default:()=>S});var n=r(68175),a=r(28407),i=r(73925),o=r(70232),c=r.n(o),u=r(55429),s=(r(15647),r(48147)),l=r(91252),p=r(33268),d=r(43502),m=r(13563),g=r(78060),b=r(99966),f=r(32455),y=r(77532),v=r(85220),k=r(23173),h=r(74552),A=r(59530),O=r(69796),E=r(87591),w=r(54350),D=r(23470),j=r(61541);function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C=(0,h.A)((function(e){return{wrapper:{height:"100%",background:e.palette.secondary.main,overflow:"hidden"},header:{background:"#30518c",fontSize:20,padding:15,lineHeight:"50px",height:78},headerAction:{},emptyMsg:{width:"100%",textAlign:"center",fontSize:20,fontWeight:"bold",marginTop:"25%"},fab:{backgroundColor:"#30518c",position:"absolute",bottom:"20%",right:"10%"},list:{height:"100%",overflowX:"hidden",overflowY:"auto"},editorField:{marginBottom:15}}})),K=[{value:"upgrade",name:"Manage Upgrades"},{value:"furniture",name:"Manage Furniture"}];const S=function(e){var t=e.property,r=e.onRefresh,o=e.myKey,h=C(),P=(0,D.MW)(),S=(0,u.useState)(!1),I=(0,i.A)(S,2),F=I[0],N=I[1],H=(0,u.useState)(!1),R=(0,i.A)(H,2),U=R[0],T=R[1],W=(0,u.useState)(Object()),M=(0,i.A)(W,2),B=M[0],q=M[1],z=(0,u.useState)({}),L=(0,i.A)(z,2),Y=L[0],_=L[1],V=function(){var e=(0,a.A)(c().mark((function e(n){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),N(!0),e.prev=2,e.next=5,j.A.send("Home:CreateDigiKey",{updating:null==Y?void 0:Y.updating,id:t.id,target:+(null==Y?void 0:Y.target),permissions:B});case 5:return e.next=7,e.sent.json();case 7:if((a=e.sent).error){e.next=14;break}P(null!=Y&&Y.updating?"DigiKey Has Been Updated":"New DigiKey Has Been Issued"),T(!1),r(),e.next=31;break;case 14:e.t0=a.code,e.next=1===e.t0?17:2===e.t0?19:3===e.t0?21:4===e.t0?23:5===e.t0?25:6===e.t0?27:7===e.t0?29:31;break;case 17:return P("Error Occured"),e.abrupt("break",31);case 19:return P("Invalid Property"),e.abrupt("break",31);case 21:return P("Not Allowed"),e.abrupt("break",31);case 23:return P("Invalid Target Player"),e.abrupt("break",31);case 25:return P("Invalid Target Character"),e.abrupt("break",31);case 27:return P("Person Already Has DigiKey For Property"),e.abrupt("break",31);case 29:return P("Error Occured Issuing DigiKey"),e.abrupt("break",31);case 31:e.next=37;break;case 33:e.prev=33,e.t1=e.catch(2),console.log(e.t1),P("Unable to Create DigiKey");case 37:N(!1);case 38:case"end":return e.stop()}}),e,null,[[2,33]])})));return function(t){return e.apply(this,arguments)}}();return u.createElement("div",{className:h.wrapper},u.createElement(s.A,{className:h.list},Object.keys(t.keys).sort((function(e,r){return t.keys[r].Owner-t.keys[e].Owner})).map((function(e){var n=t.keys[e];return u.createElement(w.default,{key:e,property:t,data:n,canRevoke:o.Owner&&!n.Owner,onRefresh:r,onUpdate:function(){return function(e){var t;q(null!==(t=e.Permissions)&&void 0!==t?t:Object()),_({updating:!0,target:e.SID}),T(!0)}(n)}})}))),o.Owner&&u.createElement(u.Fragment,null,u.createElement(l.A,{className:h.fab,onClick:function(){_({}),T(!0)}},u.createElement(A.g,{icon:["fas","plus"]})),u.createElement(E.aF,{form:!0,formStyle:{position:"relative"},disabled:F,open:U,title:null!=Y&&Y.updating?"Update DigiKey":"Create New DigiKey",onAccept:V,onClose:function(){return T(!1)},submitLang:null!=Y&&Y.updating?"Update":"Create"},u.createElement(u.Fragment,null,F&&u.createElement(E.aH,{static:!0,text:null!=Y&&Y.updating?"Updating DigiKey":"Creating DigiKey"}),u.createElement(O.A,{fullWidth:!0,required:!0,label:"Target State ID",name:"target",type:"tel",isNumericString:!0,customInput:p.A,disabled:F||(null==Y?void 0:Y.updating),className:h.editorField,value:Y.target,onChange:function(e){_(x(x({},Y),{},(0,n.A)({},e.target.name,e.target.value)))}}),u.createElement(d.A,{fullWidth:!0,className:h.editorField},u.createElement(m.A,{id:"permissions"},"Permissions"),u.createElement(g.A,{id:"permissions",name:"permissions",disabled:F,value:Object.keys(B),labelId:"permissions",multiple:!0,fullWidth:!0,input:u.createElement(b.A,{fullWidth:!0,label:"Permissions"}),renderValue:function(e){return e.map((function(e){var t,r;return null!==(t=null===(r=K.find((function(t){return t.value==e})))||void 0===r?void 0:r.name)&&void 0!==t?t:e})).join(", ")},onChange:function(e){var t=Object();e.target.value.map((function(e){t[e]=!0})),q(t)}},K.map((function(e){return u.createElement(f.A,{key:e.value,value:e.value},u.createElement(y.A,{checked:Object.keys(B).indexOf(e.value)>-1}),u.createElement(v.A,{primary:e.name}))}))),u.createElement(k.A,null,"Select Permissions"))))))}}}]);