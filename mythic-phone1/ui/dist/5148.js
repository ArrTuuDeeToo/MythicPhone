"use strict";(self.webpackChunkmythic_phone=self.webpackChunkmythic_phone||[]).push([[473,5148],{50473:(e,t,r)=>{r.r(t),r.d(t,{DeleteConvo:()=>m,ReadConvo:()=>u,SendMessage:()=>p});var n=r(68175),a=r(28407),o=r(70232),i=r.n(o),l=r(61541);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p=function(e){return function(){var t=(0,a.A)(i().mark((function t(r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.A.send("SendMessage",e);case 3:return t.next=5,t.sent.json();case 5:if(null==t.sent){t.next=11;break}return r({type:"ADD_DATA",payload:{type:"messages",first:!0,data:s({},e)}}),t.abrupt("return",!0);case 11:return t.abrupt("return",!1);case 12:t.next=18;break;case 14:return t.prev=14,t.t0=t.catch(0),console.log(t.t0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}()},u=function(e,t){return function(r){l.A.send("ReadConvo",e).then((function(){r({type:"SET_DATA",payload:{type:"messages",data:t.map((function(t){return s(s({},t),{},{unread:t.number!==e&&t.unread})}))}})})).catch((function(e){}))}},m=function(e,t,r){return function(t){l.A.send("DeleteConvo",e).then((function(){return t({type:"SET_DATA",payload:{type:"messages",data:r.filter((function(t){return t.number!=e}))}}),!0})).catch((function(e){return!1}))}}},55148:(e,t,r)=>{r.r(t),r.d(t,{default:()=>N});var n=r(28407),a=r(73925),o=r(70232),i=r.n(o),l=r(55429),c=r(15647),s=r(64965),p=r(57527),u=r(1310),m=r(86979),d=r(20500),f=r(72856),g=r(75586),h=r(31699),b=r(46134),v=r(51959),x=r(59530),A=r(60737),y=r(93632),k=r.n(y),C=r(51698),w=r.n(C),E=r(87275),D=r(50473),S=r(23470),B=r(61541),T=r(97725);const N=(0,c.Ng)(null,{SendMessage:D.SendMessage,DeleteConvo:D.DeleteConvo,ReadConvo:D.ReadConvo})((function(e){var t=(0,S.MW)(),r=(0,s.W6)(),o=e.match.params.number,y=(0,c.d4)((function(e){return e.data.data.contacts})).filter((function(e){return e.number===o}))[0],C=(0,c.d4)((function(e){return e.data.data.messages})),D=(0,c.d4)((function(e){return e.data.data.player})),N=(0,c.d4)((function(e){return e.call.call})),O=(0,l.useState)([]),I=(0,a.A)(O,2),z=I[0],j=I[1];(0,l.useEffect)((function(){j(C.filter((function(e){return e.number===o})).sort((function(e,t){return t.time-e.time}))),C.filter((function(e){return e.number===o&&e.unread})).length>0&&e.ReadConvo(o,C)}),[C]);var R=(0,v.A)((function(e){return{wrapper:{height:"100%",background:e.palette.secondary.main,overflow:"hidden"},header:{background:null!=y?y.color:e.palette.primary.main,fontSize:20,padding:15,lineHeight:"45px"},avatar:{color:"#fff",height:45,width:45},avatarFav:{color:"#fff",height:45,width:45,border:"2px solid gold"},messageAction:{textAlign:"center","&:hover":{color:e.palette.text.main,transition:"color ease-in 0.15s"}},body:{padding:10,height:"75%",display:"flex",flexDirection:"column-reverse",overflowX:"hidden",overflowY:"auto","&::-webkit-scrollbar":{width:6},"&::-webkit-scrollbar-thumb":{background:"#ffffff52"},"&::-webkit-scrollbar-thumb:hover":{background:e.palette.primary.main},"&::-webkit-scrollbar-track":{background:"transparent"}},input:{width:"100%",padding:"0 10px"},textInput:{width:"100%",marginTop:"0 !important"},submitBtn:{height:"100%",fontSize:30,textAlign:"center",borderBottom:"1px solid rgba(255, 255, 255, 0.7)","&:hover":{borderBottom:"2px solid #fff",color:e.palette.primary.main,transition:"color, border-bottom ease-in 0.15s"}},submitBtnDisabled:{height:"100%",fontSize:30,textAlign:"center",borderBottom:"1px solid rgba(255, 255, 255, 0.7)",filter:"brightness(0.25)"},submitIcon:{display:"block",margin:"auto",height:"100%",width:"40%"},textWrap:{width:"100%",fontSize:16,margin:"20px 0px",padding:"0 10px",color:e.palette.text.light,"&:first-of-type":{marginTop:0}},myText:{marginLeft:"auto",width:"fit-content",maxWidth:"75%",padding:15,borderRadius:15,background:e.palette.secondary.dark,overflowWrap:"break-word",hyphens:"auto"},otherText:{marginRight:"auto",width:"fit-content",maxWidth:"75%",padding:15,borderRadius:15,background:null!=y?y.color:e.palette.primary.main,overflowWrap:"break-word",hyphens:"auto"},timestamp:{color:e.palette.text.main,fontSize:12,padding:"5px 5px 0px 5px"},messageImg:{display:"block",maxWidth:200},copyableText:{color:e.palette.primary.main,textDecoration:"underline","&:hover":{transition:"color ease-in 0.15s",color:e.palette.text.main,cursor:"pointer"}}}}))(),M=(0,l.useState)(!1),P=(0,a.A)(M,2),$=P[0],W=P[1],_=(0,l.useState)(""),Y=(0,a.A)(_,2),F=Y[0],L=Y[1],U=(0,l.useState)({left:110,top:0}),X=(0,a.A)(U,2),q=X[0],H=X[1],V=function(){W(!1)},Z=function(){var e=(0,n.A)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=N){e.next=14;break}return e.prev=1,e.next=4,B.A.send("CreateCall",{number:o,isAnon:!1});case 4:return e.next=6,e.sent.json();case 6:e.sent?r.push("/apps/phone/call/".concat(o)):t("Unable To Start Call"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),t("Unable To Start Call");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),G=[{regex:/^https?:\/\/(\w+\.)?imgur.com\/(\w*\d\w*)+(\.[a-zA-Z]{3})?$/gim,fn:function(e,r){return l.createElement(A.CopyToClipboard,{text:r[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},l.createElement("img",{key:e,className:R.messageImg,src:r[0]}))}},{regex:/(http|https):\/\/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)(mp4)/gim,fn:function(e,t){return l.createElement("div",null,l.createElement(k(),{key:e,volume:.25,width:"100%",controls:!0,url:"".concat(t[0])}))}},{regex:/(http|https):\/\/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)/gim,fn:function(e,r){return l.createElement(A.CopyToClipboard,{text:r[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},l.createElement("a",{className:R.copyableText},r.input))}},{regex:/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)/gim,fn:function(e,r){return l.createElement(A.CopyToClipboard,{text:r[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},l.createElement("a",{className:R.copyableText},r.input))}},{regex:/ircinvite=(\d)+/gim,fn:function(e,t){return l.createElement(E.N_,{key:e,className:R.copyableText,to:"/apps/irc/join/".concat(t[0].split("=")[1])},"IRC Invite: ",t[0].split("=")[1])}}];return l.createElement("div",{className:R.wrapper},l.createElement(p.A,{position:"static",className:R.header},l.createElement(u.Ay,{container:!0},l.createElement(u.Ay,{item:!0,xs:2},null!=y?null!=y.avatar&&""!==y.avatar?l.createElement(m.A,{className:y.favorite?R.avatarFav:R.avatar,src:y.avatar,alt:y.name.charAt(0)}):l.createElement(m.A,{className:y.favorite?R.avatarFav:R.avatar,style:{background:y.color}},y.name.charAt(0)):l.createElement(m.A,{className:R.avatar},"#")),l.createElement(u.Ay,{item:!0,xs:6},null!=y?y.name:o),l.createElement(u.Ay,{item:!0,xs:4},l.createElement(u.Ay,{container:!0},l.createElement(u.Ay,{item:!0,xs:6,className:R.messageAction},l.createElement(d.A,{onClick:Z},l.createElement(x.g,{icon:"phone"}))),l.createElement(u.Ay,{item:!0,xs:6,className:R.messageAction},l.createElement(d.A,{onClick:function(e){e.preventDefault(),H({left:e.clientX-2,top:e.clientY-4}),W(!0)}},l.createElement(x.g,{icon:"ellipsis-vertical"})))))),l.createElement(f.A,{anchorReference:"anchorPosition",anchorPosition:q,keepMounted:!0,open:$,onClose:V},l.createElement(g.A,{onClick:function(){null!=y?r.push("/apps/contacts/edit/".concat(y._id)):r.push("/apps/contacts/add/".concat(o))}},null!=y?"View Contact":"Create Contact"),l.createElement(g.A,{onClick:function(){e.DeleteConvo(o,D.Phone,C)?(t("Conversation Deleted"),r.goBack()):t("Unable To Delete Conversation"),V()}},"Delete Conversation"))),l.createElement("div",{className:R.body},z.map((function(e,t){return l.createElement("div",{key:t,className:R.textWrap},l.createElement(h.A,{className:1===e.method?R.myText:R.otherText},T(G)(e.message)),l.createElement("div",{className:R.timestamp,style:{textAlign:1===e.method?"right":"left"}},l.createElement(w(),{titleFormat:"M/D/YYYY h:mm:ss A",withTitle:!0,fromNow:!0},+e.time)))}))),l.createElement("div",{className:R.input},l.createElement(u.Ay,{container:!0},l.createElement(u.Ay,{item:!0,xs:10},l.createElement(b.A,{variant:"standard",className:R.textInput,label:"Send New Message",multiline:!0,rows:"4",value:F,onChange:function(e){L(e.target.value)}})),l.createElement(u.Ay,{item:!0,xs:2},l.createElement("div",{className:""!==F?R.submitBtn:R.submitBtnDisabled,onClick:function(t){t.preventDefault(),""!==F&&(e.SendMessage({owner:D.Phone,number:o,method:1,time:Date.now(),message:F}),L(""))}},l.createElement(x.g,{icon:"paper-plane",className:R.submitIcon}))))))}))},57527:(e,t,r)=>{r.d(t,{A:()=>x});var n=r(86887),a=r(64180),o=r(55429),i=r(34164),l=r(7413),c=r(23805),s=r(29115),p=r(10016),u=r(31699),m=r(52679),d=r(33899);function f(e){return(0,d.Ay)("MuiAppBar",e)}(0,m.A)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);var g=r(64922);const h=["className","color","enableColorOnDark","position"],b=(e,t)=>e?`${null==e?void 0:e.replace(")","")}, ${t})`:t,v=(0,c.Ay)(u.A,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,t[`position${(0,p.A)(r.position)}`],t[`color${(0,p.A)(r.color)}`]]}})((({theme:e,ownerState:t})=>{const r="light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900];return(0,a.A)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===t.position&&{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===t.position&&{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},"sticky"===t.position&&{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},"static"===t.position&&{position:"static"},"relative"===t.position&&{position:"relative"},!e.vars&&(0,a.A)({},"default"===t.color&&{backgroundColor:r,color:e.palette.getContrastText(r)},t.color&&"default"!==t.color&&"inherit"!==t.color&&"transparent"!==t.color&&{backgroundColor:e.palette[t.color].main,color:e.palette[t.color].contrastText},"inherit"===t.color&&{color:"inherit"},"dark"===e.palette.mode&&!t.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===t.color&&(0,a.A)({backgroundColor:"transparent",color:"inherit"},"dark"===e.palette.mode&&{backgroundImage:"none"})),e.vars&&(0,a.A)({},"default"===t.color&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette.AppBar.defaultBg:b(e.vars.palette.AppBar.darkBg,e.vars.palette.AppBar.defaultBg),"--AppBar-color":t.enableColorOnDark?e.vars.palette.text.primary:b(e.vars.palette.AppBar.darkColor,e.vars.palette.text.primary)},t.color&&!t.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette[t.color].main:b(e.vars.palette.AppBar.darkBg,e.vars.palette[t.color].main),"--AppBar-color":t.enableColorOnDark?e.vars.palette[t.color].contrastText:b(e.vars.palette.AppBar.darkColor,e.vars.palette[t.color].contrastText)},!["inherit","transparent"].includes(t.color)&&{backgroundColor:"var(--AppBar-background)"},{color:"inherit"===t.color?"inherit":"var(--AppBar-color)"},"transparent"===t.color&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))})),x=o.forwardRef((function(e,t){const r=(0,s.b)({props:e,name:"MuiAppBar"}),{className:o,color:c="primary",enableColorOnDark:u=!1,position:m="fixed"}=r,d=(0,n.A)(r,h),b=(0,a.A)({},r,{color:c,position:m,enableColorOnDark:u}),x=(e=>{const{color:t,position:r,classes:n}=e,a={root:["root",`color${(0,p.A)(t)}`,`position${(0,p.A)(r)}`]};return(0,l.A)(a,f,n)})(b);return(0,g.jsx)(v,(0,a.A)({square:!0,component:"header",ownerState:b,elevation:4,className:(0,i.A)(x.root,o,"fixed"===m&&"mui-fixed"),ref:t},d))}))},97725:e=>{e.exports=function(e){var t=0;function r(e,n){if(!e.fn||"function"!=typeof e.fn)return n;if(!(e.regex&&e.regex instanceof RegExp))return n;if("string"==typeof n){for(var a=e.regex,o=null,i=[];null!==(o=a.exec(n));){var l=o.index,c=o[0];i.push(n.substring(0,l)),i.push(e.fn(++t,o)),n=n.substring(l+c.length,n.length+1),a.lastIndex=0}return i.push(n),i}return Array.isArray(n)?n.map((function(t){return r(e,t)})):n}return function(t){return e&&Array.isArray(e)&&e.length?(e.forEach((function(e){return t=r(e,t)})),t):t}}}}]);