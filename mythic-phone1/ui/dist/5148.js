"use strict";(self.webpackChunkmythic_phone=self.webpackChunkmythic_phone||[]).push([[473,5148],{50473:(e,t,n)=>{n.r(t),n.d(t,{DeleteConvo:()=>m,ReadConvo:()=>p,SendMessage:()=>u});var r=n(68175),o=n(28407),a=n(70232),i=n.n(a),l=n(61541);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(e){return function(){var t=(0,o.A)(i().mark((function t(n){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l.A.send("SendMessage",e);case 3:return t.next=5,t.sent.json();case 5:if(null==t.sent){t.next=11;break}return n({type:"ADD_DATA",payload:{type:"messages",first:!0,data:s({},e)}}),t.abrupt("return",!0);case 11:return t.abrupt("return",!1);case 12:t.next=18;break;case 14:return t.prev=14,t.t0=t.catch(0),console.log(t.t0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}()},p=function(e,t){return function(n){l.A.send("ReadConvo",e).then((function(){n({type:"SET_DATA",payload:{type:"messages",data:t.map((function(t){return s(s({},t),{},{unread:t.number!==e&&t.unread})}))}})})).catch((function(e){}))}},m=function(e,t,n){return function(t){l.A.send("DeleteConvo",e).then((function(){return t({type:"SET_DATA",payload:{type:"messages",data:n.filter((function(t){return t.number!=e}))}}),!0})).catch((function(e){return!1}))}}},55148:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var r=n(28407),o=n(73925),a=n(70232),i=n.n(a),l=n(55429),c=n(15647),s=n(64965),u=n(142),p=n(79111),m=n(44686),d=n(26573),f=n(66304),h=n(32455),g=n(28744),b=n(33268),x=n(74552),y=n(59530),v=n(60737),A=n(93632),k=n.n(A),C=n(51698),w=n.n(C),E=n(87275),S=n(50473),D=n(23470),T=n(61541),N=n(97725);const O=(0,c.Ng)(null,{SendMessage:S.SendMessage,DeleteConvo:S.DeleteConvo,ReadConvo:S.ReadConvo})((function(e){var t=(0,D.MW)(),n=(0,s.W6)(),a=e.match.params.number,A=(0,c.d4)((function(e){return e.data.data.contacts})).filter((function(e){return e.number===a}))[0],C=(0,c.d4)((function(e){return e.data.data.messages})),S=(0,c.d4)((function(e){return e.data.data.player})),O=(0,c.d4)((function(e){return e.call.call})),I=(0,l.useState)([]),z=(0,o.A)(I,2),j=z[0],B=z[1];(0,l.useEffect)((function(){B(C.filter((function(e){return e.number===a})).sort((function(e,t){return t.time-e.time}))),C.filter((function(e){return e.number===a&&e.unread})).length>0&&e.ReadConvo(a,C)}),[C]);var R=(0,x.A)((function(e){return{wrapper:{height:"100%",background:e.palette.secondary.main,overflow:"hidden"},header:{background:null!=A?A.color:e.palette.primary.main,fontSize:20,padding:15,lineHeight:"45px"},avatar:{color:"#fff",height:45,width:45},avatarFav:{color:"#fff",height:45,width:45,border:"2px solid gold"},messageAction:{textAlign:"center","&:hover":{color:e.palette.text.main,transition:"color ease-in 0.15s"}},body:{padding:10,height:"75%",display:"flex",flexDirection:"column-reverse",overflowX:"hidden",overflowY:"auto","&::-webkit-scrollbar":{width:6},"&::-webkit-scrollbar-thumb":{background:"#ffffff52"},"&::-webkit-scrollbar-thumb:hover":{background:e.palette.primary.main},"&::-webkit-scrollbar-track":{background:"transparent"}},input:{width:"100%",padding:"0 10px"},textInput:{width:"100%",marginTop:"0 !important"},submitBtn:{height:"100%",fontSize:30,textAlign:"center",borderBottom:"1px solid rgba(255, 255, 255, 0.7)","&:hover":{borderBottom:"2px solid #fff",color:e.palette.primary.main,transition:"color, border-bottom ease-in 0.15s"}},submitBtnDisabled:{height:"100%",fontSize:30,textAlign:"center",borderBottom:"1px solid rgba(255, 255, 255, 0.7)",filter:"brightness(0.25)"},submitIcon:{display:"block",margin:"auto",height:"100%",width:"40%"},textWrap:{width:"100%",fontSize:16,margin:"20px 0px",padding:"0 10px",color:e.palette.text.light,"&:first-of-type":{marginTop:0}},myText:{marginLeft:"auto",width:"fit-content",maxWidth:"75%",padding:15,borderRadius:15,background:e.palette.secondary.dark,overflowWrap:"break-word",hyphens:"auto"},otherText:{marginRight:"auto",width:"fit-content",maxWidth:"75%",padding:15,borderRadius:15,background:null!=A?A.color:e.palette.primary.main,overflowWrap:"break-word",hyphens:"auto"},timestamp:{color:e.palette.text.main,fontSize:12,padding:"5px 5px 0px 5px"},messageImg:{display:"block",maxWidth:200},copyableText:{color:e.palette.primary.main,textDecoration:"underline","&:hover":{transition:"color ease-in 0.15s",color:e.palette.text.main,cursor:"pointer"}}}}))(),M=(0,l.useState)(!1),P=(0,o.A)(M,2),W=P[0],$=P[1],_=(0,l.useState)(""),Y=(0,o.A)(_,2),F=Y[0],L=Y[1],U=(0,l.useState)({left:110,top:0}),X=(0,o.A)(U,2),q=X[0],H=X[1],V=function(){$(!1)},Z=function(){var e=(0,r.A)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=O){e.next=14;break}return e.prev=1,e.next=4,T.A.send("CreateCall",{number:a,isAnon:!1});case 4:return e.next=6,e.sent.json();case 6:e.sent?n.push("/apps/phone/call/".concat(a)):t("Unable To Start Call"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),t("Unable To Start Call");case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),G=[{regex:/^https?:\/\/(\w+\.)?imgur.com\/(\w*\d\w*)+(\.[a-zA-Z]{3})?$/gim,fn:function(e,n){return l.createElement(v.CopyToClipboard,{text:n[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},l.createElement("img",{key:e,className:R.messageImg,src:n[0]}))}},{regex:/(http|https):\/\/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)(mp4)/gim,fn:function(e,t){return l.createElement("div",null,l.createElement(k(),{key:e,volume:.25,width:"100%",controls:!0,url:"".concat(t[0])}))}},{regex:/(http|https):\/\/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)/gim,fn:function(e,n){return l.createElement(v.CopyToClipboard,{text:n[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},l.createElement("a",{className:R.copyableText},n.input))}},{regex:/(\S+)\.([a-z]{2,}?)(.*?)( |\,|$|\.)/gim,fn:function(e,n){return l.createElement(v.CopyToClipboard,{text:n[0],key:e,onCopy:function(){return t("Link Copied To Clipboard")}},l.createElement("a",{className:R.copyableText},n.input))}},{regex:/ircinvite=(\d)+/gim,fn:function(e,t){return l.createElement(E.N_,{key:e,className:R.copyableText,to:"/apps/irc/join/".concat(t[0].split("=")[1])},"IRC Invite: ",t[0].split("=")[1])}}];return l.createElement("div",{className:R.wrapper},l.createElement(u.A,{position:"static",className:R.header},l.createElement(p.Ay,{container:!0},l.createElement(p.Ay,{item:!0,xs:2},null!=A?null!=A.avatar&&""!==A.avatar?l.createElement(m.A,{className:A.favorite?R.avatarFav:R.avatar,src:A.avatar,alt:A.name.charAt(0)}):l.createElement(m.A,{className:A.favorite?R.avatarFav:R.avatar,style:{background:A.color}},A.name.charAt(0)):l.createElement(m.A,{className:R.avatar},"#")),l.createElement(p.Ay,{item:!0,xs:6},null!=A?A.name:a),l.createElement(p.Ay,{item:!0,xs:4},l.createElement(p.Ay,{container:!0},l.createElement(p.Ay,{item:!0,xs:6,className:R.messageAction},l.createElement(d.A,{onClick:Z},l.createElement(y.g,{icon:"phone"}))),l.createElement(p.Ay,{item:!0,xs:6,className:R.messageAction},l.createElement(d.A,{onClick:function(e){e.preventDefault(),H({left:e.clientX-2,top:e.clientY-4}),$(!0)}},l.createElement(y.g,{icon:"ellipsis-vertical"})))))),l.createElement(f.A,{anchorReference:"anchorPosition",anchorPosition:q,keepMounted:!0,open:W,onClose:V},l.createElement(h.A,{onClick:function(){null!=A?n.push("/apps/contacts/edit/".concat(A._id)):n.push("/apps/contacts/add/".concat(a))}},null!=A?"View Contact":"Create Contact"),l.createElement(h.A,{onClick:function(){e.DeleteConvo(a,S.Phone,C)?(t("Conversation Deleted"),n.goBack()):t("Unable To Delete Conversation"),V()}},"Delete Conversation"))),l.createElement("div",{className:R.body},j.map((function(e,t){return l.createElement("div",{key:t,className:R.textWrap},l.createElement(g.A,{className:1===e.method?R.myText:R.otherText},N(G)(e.message)),l.createElement("div",{className:R.timestamp,style:{textAlign:1===e.method?"right":"left"}},l.createElement(w(),{titleFormat:"M/D/YYYY h:mm:ss A",withTitle:!0,fromNow:!0},+e.time)))}))),l.createElement("div",{className:R.input},l.createElement(p.Ay,{container:!0},l.createElement(p.Ay,{item:!0,xs:10},l.createElement(b.A,{variant:"standard",className:R.textInput,label:"Send New Message",multiline:!0,rows:"4",value:F,onChange:function(e){L(e.target.value)}})),l.createElement(p.Ay,{item:!0,xs:2},l.createElement("div",{className:""!==F?R.submitBtn:R.submitBtnDisabled,onClick:function(t){t.preventDefault(),""!==F&&(e.SendMessage({owner:S.Phone,number:a,method:1,time:Date.now(),message:F}),L(""))}},l.createElement(y.g,{icon:"paper-plane",className:R.submitIcon}))))))}))},142:(e,t,n)=>{n.d(t,{A:()=>b});var r=n(86887),o=n(64180),a=n(55429),i=n(1551),l=n(50035),c=n(93119),s=n(88594),u=n(69921),p=n(28744),m=n(35457);function d(e){return(0,m.A)("MuiAppBar",e)}(0,n(40725).A)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent"]);var f=n(64922);const h=["className","color","enableColorOnDark","position"],g=(0,c.Ay)(p.A,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${(0,u.A)(n.position)}`],t[`color${(0,u.A)(n.color)}`]]}})((({theme:e,ownerState:t})=>{const n="light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900];return(0,o.A)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===t.position&&{position:"fixed",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===t.position&&{position:"absolute",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0},"sticky"===t.position&&{position:"sticky",zIndex:e.zIndex.appBar,top:0,left:"auto",right:0},"static"===t.position&&{position:"static"},"relative"===t.position&&{position:"relative"},"default"===t.color&&{backgroundColor:n,color:e.palette.getContrastText(n)},t.color&&"default"!==t.color&&"inherit"!==t.color&&"transparent"!==t.color&&{backgroundColor:e.palette[t.color].main,color:e.palette[t.color].contrastText},"inherit"===t.color&&{color:"inherit"},"dark"===e.palette.mode&&!t.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===t.color&&(0,o.A)({backgroundColor:"transparent",color:"inherit"},"dark"===e.palette.mode&&{backgroundImage:"none"}))})),b=a.forwardRef((function(e,t){const n=(0,s.A)({props:e,name:"MuiAppBar"}),{className:a,color:c="primary",enableColorOnDark:p=!1,position:m="fixed"}=n,b=(0,r.A)(n,h),x=(0,o.A)({},n,{color:c,position:m,enableColorOnDark:p}),y=(e=>{const{color:t,position:n,classes:r}=e,o={root:["root",`color${(0,u.A)(t)}`,`position${(0,u.A)(n)}`]};return(0,l.A)(o,d,r)})(x);return(0,f.jsx)(g,(0,o.A)({square:!0,component:"header",ownerState:x,elevation:4,className:(0,i.A)(y.root,a,"fixed"===m&&"mui-fixed"),ref:t},b))}))},97725:e=>{e.exports=function(e){var t=0;function n(e,r){if(!e.fn||"function"!=typeof e.fn)return r;if(!(e.regex&&e.regex instanceof RegExp))return r;if("string"==typeof r){for(var o=e.regex,a=null,i=[];null!==(a=o.exec(r));){var l=a.index,c=a[0];i.push(r.substring(0,l)),i.push(e.fn(++t,a)),r=r.substring(l+c.length,r.length+1),o.lastIndex=0}return i.push(r),i}return Array.isArray(r)?r.map((function(t){return n(e,t)})):r}return function(t){return e&&Array.isArray(e)&&e.length?(e.forEach((function(e){return t=n(e,t)})),t):t}}}}]);